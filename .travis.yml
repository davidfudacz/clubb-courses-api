language: node_js
node_js:
  - node # uses most recent stable node version
services:
  - postgresql # starts up postgres
addons:
  postgresql: '9.6' # highest available postgres version on Travis
dist: trusty # uses trusty environment
sudo: false # when on trusty, uses Docker containers for speed
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm ci # faster, goes only from package-lock
before_script:
  - psql -c 'create database "boilermaker-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)

before_deploy:
  - npm run build-client # make the bundle
  - rm -rf node_modules # omit from the tarball, since we skip cleanup
deploy:
  skip_cleanup: true # prevents travis from deleting the build
  provider: heroku
  app: teesheetapp # see README
  api_key:
    secure: "XzhYJi1Lj2L/0LHW1QmKHbQavqnBWJX3FDzLb3Drou2FHtF1VBXbtVrbBCUHRml651JoRJ9tqF/6Cf10Ph9Od14mysKI5hTs0Z4+xQWtfGRjIZFI9BhyLGCrVNEBrRaGHafT0zgpn03Q+HJvDVqhgC252qujOxfzjhUNNxf5S/7ELhzN7S55zBqxgzhTzlkS6mYtqgjWkRPUmm5ke9mxSc9vTRzvJbAydnUAzuUVEBF4prLEnanrGF0pPQIo+IkFw0kEggRE+iS4waqCY+5LxmhByhPNDBH9VCV6jBKe3ESkLyJDTq1N8susHIqhjeqBclRLZOCLIpAR6RVStIfak19JAjVpH/qzGnd7/pvp+9j8ZFyjSDcHiFGy7+43PTpPkT3NVlXjcpR0KXaBnbTJz297Jw4Wf0Y8Eh/KVszNO22SSurqVKG0La91fj/PLJt81vwfsAjooLTkJ23Khzn9qJ7mCFqDuTZzctMnNAlhtS4B4P8NX+wv88clOoVBw/O4/PF9d5ohrg/dzA1hrvYWynM/vHiS9MWE2hr3kqbaPNInl09Lh0cc5r0FtlHJLv2+WN4Gm+6lMOekgiz0r45cjAn2iVS92twd700YSc3RBtJKG7qJMT+0P7Pzb3CrJDffsyjiKUSJQDcTmrtYIHiUyNXSG2CGVpPPge4G8n4n9lw="